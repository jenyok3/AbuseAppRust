## Snapshot (2026-02-28) - launch stability / tray / logs

### Закрито в цій сесії
- Notes: прибрано застарілий пункт у відкритих питаннях про невидимі ефекти тем (вже виправлено).
- Daily reminders/logs: виправлено зламаний текст у форматі `????...: <title>` у сповіщеннях і в "Останніх діях"; додано санітизацію логів при читанні/записі в `localStore`.
- Telegram UI: нумерація карток акаунтів тепер показує глобальний номер із повного списку навіть під фільтрами (з нотатками/хештегами/пошуком), а не `index+1` від видимого піднабору.
- Telegram launch stop: виправлено сценарій "Завершити" під час масового запуску - додано backend cancel-команду (`request_telegram_launch_cancel`) і інтеграцію у фронт; нові інстанси не повинні продовжувати старт після скасування.
- Tauri/Tray: додано `tauri-plugin-single-instance`; повторний запуск із ярлика тепер фокусує існуючий інстанс замість створення другого процесу/другої іконки в треї.
- Telegram launch reliability: реалізовано `health-check + 1 quick retry` після кожного батчу (у т.ч. перший батч і продовження по F6) для профілів, що "відпали" одразу після старту.

### Перевірки
- `npm run check` - проходить.
- `cargo check` - проходить.

### Поточний статус / Ризики
- Quick retry зараз завжди увімкнений (константи в коді); за потреби можна винести в Settings як перемикач.
- Значення "запущено" у тостах після батчу показує фактично живі інстанси після quick retry, тоді як прогрес батчу рахується по оброблених профілях.
## Snapshot (2026-02-27) — i18n/Settings UI polishing

### Закрито в цій сесії
- i18n: доведено мультимовність інтерфейсу (uk/en/ru) у ключових модулях Telegram/модалках/віджетах, виправлено залишки хардкоду.
- Encoding fix: виправлено зламані рядки `����...` у модальних вікнах (`AuthOnboardingModal`, `CustomLinkModal`, `ProjectModal`) та календарних віджетах (`glass-calendar`, `visualize-booking`) з переведенням у UTF-8.
- Daily Tasks: заголовок віджета зафіксовано як `Daily` (без перекладу за вимогою).
- Telegram: локалізовано залишок бейджа `link` і alt для іконки blocked-стану.
- Settings/UI: селект мови переведено з нативного `<select>` на дизайн-системний `Select`; виправлено стилізацію дропдауна та вирівнювання стрілки.
- Settings/UI: картку мови перенесено вниз сторінки налаштувань; прибрано підписи під селектом мови; заголовок змінено на `Мова`.
- Settings/UI: прибрано допоміжні описи для полів Telegram/Chrome (про потоки та шляхи до папок).
- Settings/UI: прибрано підзаголовок сторінки `Керування параметрами системи`.

### Перевірки
- `npm run check` — проходить.

### Поточний статус / Ризики
- Основні видимі `����...` у використаних компонентах виправлені.
- Потенційно можуть лишатися англомовні `sr-only` підписи у базових `ui/*` компонентах (accessibility), якщо потрібна повна локалізація цього шару.
# Next Session Plan - Abuse-App

## Snapshot (2026-02-27) — ефекти тем

### Закрито в цій сесії
- Themes: повністю замінено tsParticles на кастомний Canvas-рендер сезонних ефектів; нові ефекти — Сакура/Дощ/Опале листя/Сніг.
- Themes: оновлено перемикачі ефектів у налаштуваннях, додано регулятори швидкості для Сакури/Дощу/Опалого листя; сніг залишив повзунок швидкості.
- Themes: прибрано “перемотку” при зміні швидкості — швидкість оновлюється плавно без ресету частинок.
- Themes: тюнінг траєкторій/швидкостей (без діагоналі для Сакури/Дощу/Опалого листя, повільніші коливання для снігу/сакури, дощ — тонкі довші смуги).
- Themes: опале листя — м’якші коливання та баланс спавну по ширині (35% центр, 32.5% ліва, 32.5% права).
- UI: прибрано `bg-black` та inline `backgroundColor` з основних сторінок (Telegram/Settings/Chrome/NotFound), фон перенесено на `body` в App.
- Dev: прибрано залежності `tsparticles` і `@tsparticles/react`.

### Перевірки
- `npm run check` — проходить.

## Snapshot (2026-02-27)

### Закрито в цій сесії
- Telegram: стабілізовано закриття батчів — додано ретраї закриття по папках та визначення реальних PID за `TG N` (нова команда `get_telegram_pids_for_accounts`), F6 тепер закриває надійніше.
- Telegram: прибрано логування в “Останні дії” для відкриття/закриття акаунта і повідомлення “Продовжено запуск…”. Повідомлення про кастомне посилання змінено на “Запущено своє посилання <name>”, завершення — “Завершено <name>”.
- Daily Tasks: при позначенні задачі як виконаної очищаються нагадування; в модальному “Заплановано” показуються лише майбутні ненагадані записи.
- Telegram: toasts для нотаток/назви акаунта показують номер картки (index+1), а не внутрішній ID; логування цих дій у “Останні дії” прибрано.
- Themes: інтегровано tsParticles (Winter/Spring/Summer/Autumn), увімкнено перемикачі сезонів у налаштуваннях, виправлено ініціалізацію через `initParticlesEngine` та фіксований контейнер.
- Dev: після оновлення Node до 25.6.1 перебудовано `better-sqlite3`; у `server/index.ts` прибрано `reusePort` і змінено host на `127.0.0.1` для Windows.

### Перевірки
- `npm run check` — проходить.

## Snapshot (2026-02-26)

### Закрито в цій сесії
- Виправлено шлях збірки Tauri: `frontendDist` тепер `../dist/public`.
- Daily Tasks: при виконанні задачі нагадування більше не скидаються.
- Daily Tasks: додано підтримку кількох нагадувань на одну задачу, оновлено планувальник і UI редагування.
- Daily Tasks: прибрано кнопку “Додати нагадування”, додавання відбувається через “Зберегти”; інпути дати/часу очищаються після збереження.
- Виправлено тексти toast для нотаток у Telegram: “Нотатку оновлено”, опис “Акаунт {назва}”.
- Видалено сторінку `Accounts` і маршрут `/accounts`.
- Картки акаунтів у Telegram: показ нумерації 1..N, hover-підміна на `account.name`, кнопка копіювання назви з’являється при наведенні.
- Виправлено кодування `notes/next-session.md` (UTF-8).

### Перевірки
- `npm run check` — проходить.

## Snapshot (2026-02-26) — доповнення

### Закрито в цій сесії
- Telegram: додано закриття акаунтів по папках `TG N` як другий прохід (нова команда `close_telegram_accounts_batch`), викликається після закриття PID-ів при F6 та при “Закрити всі”.
- Telegram UI: кнопка “Скасувати” в блоці прогресу перейменована на “Завершити”.
- Іконки: згенеровано padded-джерело `assets/icon-source-1024.png` і перегенеровано всі іконки через `npx tauri icon` (включно `icon.ico`) для виправлення мильних/обрізаних ярликів.

## Snapshot (2026-02-26) — фікс іконок Windows (повторно)

### Закрито в цій сесії
- Проведено діагностику проблеми мильних/обрізаних іконок після перевстановлення: підтверджено, що `src-tauri/icons/icon.ico` був неякісним для Windows-випадку (не давав стабільного результату для taskbar/desktop/tray).
- Іконки перегенеровано вручну з `assets/logo-square.png` з контрольованими відступами та масштабом: оновлено `32x32.png`, `64x64.png`, `128x128.png`, `128x128@2x.png`, `icon.png`.
- Зібрано новий `src-tauri/icons/icon.ico` як multi-size (16/20/24/32/40/48/64/72/96/128/256) для чіткого рендеру на різних щільностях Windows.
- Додано окремі іконки для трею: `src-tauri/icons/tray-icon.png` та `src-tauri/icons/tray-icon@2x.png` (щільніший кроп, без ефекту «дуже маленької» іконки).
- Оновлено `src-tauri/src/lib.rs`: tray тепер використовує `tauri::include_image!("icons/tray-icon.png")` замість `app.default_window_icon()`.
- Піднято версію застосунку до `1.0.2` у `src-tauri/tauri.conf.json` та `src-tauri/Cargo.toml` (щоб Windows гарантовано підхопила нові ресурси іконок).
- Зібрано нові інсталятори `1.0.2`:
  - `src-tauri/target/release/bundle/nsis/AbuseApp_1.0.2_x64-setup.exe`
  - `src-tauri/target/release/bundle/msi/AbuseApp_1.0.2_x64_en-US.msi`

### Перевірки
- `cargo check` — проходить.
- `npm run check` — проходить.
- `npm run tauri:build` — проходить.

### Важливо для встановлення
- Після оновлення до `1.0.2` на Windows потрібно відкріпити старий pinned-ярлик з taskbar і закріпити знову після першого запуску нової версії, інакше може лишатися старий icon cache.

## Snapshot (2026-02-26) — Telegram акаунти (UI/імена)

### Закрито в цій сесії
- Telegram: додано локальне поле `displayName` для акаунтів (meta), без зчитування з `tdata`.
- Telegram UI: редагування імені через клік по номеру/імені; інпут мінімалістичний (прозорий, лише курсор + плейсхолдер `@user`).
- Telegram UI: якщо `displayName` порожній — не показується назва іконка копіювання; якщо є — при hover номер замінюється на ім’я і з’являється іконка копіювання.
- Telegram UI: іконка “додати хештег” перенесена в правий верхній кут картки; при наявності копіювання стає перед нею, без копіювання займає її місце.
- Telegram UI: хрестик видалення хештегу показується лише при наведенні на сам хештег.
- Telegram UI: плейсхолдер пошуку змінено на “Пошук”; лупа ховається при фокусі, відступ зліва прибирається під час вводу.

### Перевірки
- `npm run check` — проходить.


